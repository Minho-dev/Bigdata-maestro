
SELECT * FROM EX1;
ALTER TABLE EX1 ADD TOTAL NUMBER(10);
UPDATE EX1 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE YEAR = 2008;
UPDATE EX1 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE YEAR = 2009;
UPDATE EX1 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE YEAR = 2010;
UPDATE EX1 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE YEAR = 2011;
UPDATE EX1 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE YEAR = 2012;
UPDATE EX1 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE YEAR = 2013;
UPDATE EX1 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE YEAR = 2014;
UPDATE EX1 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE YEAR = 2015;
UPDATE EX1 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE YEAR = 2016;
UPDATE EX1 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE YEAR = 2017;
UPDATE EX1 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE YEAR = 2018;

SELECT YEAR, TOTAL FROM EX1;

SELECT * FROM EX2;
ALTER TABLE EX2 ADD TOTAL NUMBER(10);
UPDATE EX2 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE YEAR = 2008;
UPDATE EX2 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE YEAR = 2009;
UPDATE EX2 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE YEAR = 2010;
UPDATE EX2 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE YEAR = 2011;
UPDATE EX2 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE YEAR = 2012;
UPDATE EX2 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE YEAR = 2013;
UPDATE EX2 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE YEAR = 2014;
UPDATE EX2 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE YEAR = 2015;
UPDATE EX2 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE YEAR = 2016;
UPDATE EX2 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE YEAR = 2017;
UPDATE EX2 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE YEAR = 2018;

SELECT YEAR, TOTAL FROM EX2;

SELECT * FROM WELFARE;
DELETE FROM WELFARE
WHERE GU = '소계';

SELECT NAME AS BUILING, GU AS CITY, SUBSTR( YEAR, 3, 2 ) AS SINCE,
CASE
WHEN SUBSTR(YEAR, 1, 4 ) >= 2010 THEN '2010년대'
WHEN SUBSTR(YEAR, 1, 4 ) >= 2000 THEN '2000년대'
WHEN SUBSTR(YEAR, 1, 4 ) >= 1990 THEN '1990년대'
END AS YEARG
FROM WELFARE;

CREATE TABLE WEL_TBL AS SELECT NAME AS BUILING, GU AS CITY, SUBSTR( YEAR, 3, 2 ) AS SINCE,
CASE
WHEN SUBSTR(YEAR, 1, 4 ) >= 2010 THEN '2010년대'
WHEN SUBSTR(YEAR, 1, 4 ) >= 2000 THEN '2000년대'
WHEN SUBSTR(YEAR, 1, 4 ) >= 1990 THEN '1990년대'
END AS YEARG
FROM WELFARE;

ALTER TABLE EX3 ADD TOTAL NUMBER(10);
UPDATE EX3 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE AREA = '동구';
UPDATE EX3 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE AREA = '서구';
UPDATE EX3 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE AREA = '중구';
UPDATE EX3 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE AREA = '유성구';
UPDATE EX3 SET TOTAL = UP65 + UP70 + UP75 + UP80 + UP85 + UP90 + UP95 + UP100 WHERE AREA = '대덕구';

SELECT * FROM EX3;

SELECT W.CITY, COUNT(*) AS NUM, E.TOTAL AS POP, ROUND( ( COUNT(*) / E.TOTAL * 1000 ), 2) AS NUM_POP FROM WEL_TBL W, EX3 E WHERE W.CITY = E.AREA GROUP BY W.CITY, E.TOTAL;
